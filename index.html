<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Schengen Days</title>
  <meta name="theme-color" content="#0B1220" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="./design-tokens.css" />
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; }

    .app {
      margin: 0;
      min-height: 100%;
      font: var(--font-body)/1.4 -apple-system, BlinkMacSystemFont, "SF Pro Text", "Inter", "Segoe UI", Roboto, Arial, sans-serif;
      font-weight: var(--font-weight-body);
      color: var(--color-text-primary);
      background: var(--color-bg);
      -webkit-font-smoothing: antialiased;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
    }

    .container {
      max-width: var(--container-max-width);
      margin: 0 auto;
      padding: var(--space-sm) var(--space-sm) calc(var(--space-xxl) + env(safe-area-inset-bottom));
      display: grid;
      gap: var(--space-sm);
    }

    .card {
      background: var(--color-card-glass);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-card);
      padding: var(--card-padding);
      box-shadow: var(--shadow-card);
      backdrop-filter: var(--blur-glass);
      -webkit-backdrop-filter: var(--blur-glass);
    }

    .hero {
      display: grid;
      justify-items: center;
      text-align: center;
      gap: var(--space-md);
    }

    .ring {
      position: relative;
      width: var(--ring-size);
      height: var(--ring-size);
      display: grid;
      place-items: center;
    }

    .ringSvg {
      width: var(--ring-size);
      height: var(--ring-size);
      transform: rotate(-90deg);
    }

    .ringTrack { fill: none; stroke: var(--color-border); stroke-width: var(--ring-stroke); }
    .ringProgress {
      fill: none;
      stroke: var(--color-primary);
      stroke-width: var(--ring-stroke);
      stroke-linecap: round;
      transition: stroke-dashoffset .35s ease-out;
    }

    .ringNumber {
      position: absolute;
      font-size: var(--font-hero-number);
      font-weight: var(--font-weight-hero);
      line-height: 1;
    }

    .heroLabel {
      margin: 0;
      font-size: var(--font-hero-label);
      font-weight: var(--font-weight-title);
      color: var(--color-text-secondary);
    }

    .heroSub {
      margin: 0;
      font-size: var(--font-small);
      color: var(--color-text-muted);
    }

    .sectionTitle {
      margin: 0 0 var(--space-md);
      text-align: center;
      font-size: var(--font-section-title);
      font-weight: var(--font-weight-title);
    }

    .field { display: grid; gap: var(--space-xs); margin-bottom: var(--space-sm); }

    .fieldHead {
      display: flex;
      align-items: center;
      gap: var(--space-xs);
      font-size: var(--font-body);
      color: var(--color-text-secondary);
    }

    .fieldIcon,
    .calIcon {
      width: var(--space-md);
      height: var(--space-md);
      color: var(--color-text-muted);
      flex: 0 0 auto;
    }

    .input {
      width: 100%;
      height: var(--input-height);
      background: var(--color-card);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-input);
      color: var(--color-text-primary);
      font-size: var(--font-body);
      padding: 0 var(--space-xl) 0 var(--space-md);
      outline: none;
    }

    .input:focus { border-color: var(--color-primary); }

    .inputWrap { position: relative; }

    .inputWrap .calIcon {
      position: absolute;
      right: var(--space-md);
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
    }

    .input::-webkit-calendar-picker-indicator {
      opacity: 0;
      position: absolute;
      right: 0;
      width: var(--space-xl);
      height: 100%;
    }

    .quick-pills { display: flex; gap: var(--space-sm); margin: var(--space-sm) 0 var(--space-md); }

    .pill {
      min-width: var(--button-height);
      height: var(--button-height);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-pill);
      background: var(--color-card);
      color: var(--color-text-primary);
      font-size: var(--font-body);
      font-weight: var(--font-weight-title);
    }

    .pill.active {
      background: var(--color-primary-soft);
      border-color: var(--color-primary);
    }

    .tripMeta { margin: 0 0 var(--space-md); color: var(--color-text-secondary); }

    .btn-primary {
      width: 100%;
      height: var(--button-height);
      border: none;
      border-radius: var(--radius-button);
      background: var(--color-primary);
      color: var(--color-text-primary);
      font-size: var(--font-section-title);
      font-weight: var(--font-weight-title);
    }

    .actions { display: grid; gap: var(--space-sm); }
    .subActions { display: flex; justify-content: space-between; gap: var(--space-sm); }

    .secondary {
      border: 1px solid var(--color-border);
      background: transparent;
      color: var(--color-text-primary);
      border-radius: var(--radius-pill);
      padding: var(--space-xs) var(--space-sm);
      font-size: var(--font-small);
    }

    .error { min-height: var(--space-md); font-size: var(--font-small); color: var(--color-danger); }
    .hide { display: none; }

    .tripsTitle { margin: 0 0 var(--space-sm); font-size: var(--font-hero-label); font-weight: var(--font-weight-title); }

    .tripRow {
      display: flex;
      justify-content: space-between;
      gap: var(--space-sm);
      align-items: flex-start;
      padding: var(--space-sm);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-input);
      margin-bottom: var(--space-sm);
      background: var(--color-card);
      box-shadow: var(--shadow-soft);
    }

    .tripMain { font-weight: var(--font-weight-title); }
    .tripSub { font-size: var(--font-small); color: var(--color-text-muted); margin-top: var(--space-xs); }
    .rowBtns { display: flex; gap: var(--space-xs); }
    .iconBtn { display: inline-flex; align-items: center; gap: var(--space-xs); }
    .iconBtn.danger { color: var(--color-danger); border-color: var(--color-danger); }
    .icon { width: var(--font-small); height: var(--font-small); }

    .subtitle {
      font-size: var(--font-small);
      color: var(--color-text-muted);
      text-align: center;
      margin: var(--space-xs) 0 0;
      padding-bottom: calc(var(--space-lg) + env(safe-area-inset-bottom));
    }

    .toast {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(var(--space-xxl) + env(safe-area-inset-bottom));
      z-index: 20;
      border-radius: var(--radius-button);
      border: 1px solid var(--color-border);
      background: var(--color-card);
      box-shadow: var(--shadow-soft);
      padding: var(--space-sm) var(--space-md);
      display: flex;
      gap: var(--space-sm);
      align-items: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s ease;
    }

    .toast.show { opacity: 1; pointer-events: auto; }
  </style>
</head>
<body class="app">
  <main id="appWrap" class="container">
    <section id="hero" class="card hero" aria-live="polite">
      <div class="ring">
        <svg class="ringSvg" viewBox="0 0 180 180" aria-hidden="true">
          <circle class="ringTrack" cx="90" cy="90" r="62"></circle>
          <circle id="heroRingProgress" class="ringProgress" cx="90" cy="90" r="62"></circle>
        </svg>
        <div id="ringNumber" class="ringNumber">90</div>
      </div>
      <p id="heroLabel" class="heroLabel">Days left</p>
      <p id="heroSentence" class="heroSub">If you enter today, you must leave by —.</p>
    </section>

    <section class="card">
      <h2 class="sectionTitle">Add a trip</h2>

      <div class="field">
        <div class="fieldHead">
          <svg class="fieldIcon" viewBox="0 0 24 24" fill="none"><path d="M18 12H4m0 0 5-5m-5 5 5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <span>Entry date</span>
        </div>
        <div class="inputWrap">
          <input class="input" type="date" id="entryDate" />
          <svg class="calIcon" viewBox="0 0 24 24" fill="none"><path d="M7 2v3M17 2v3M3 9h18M5 5h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>

      <div class="field">
        <div class="fieldHead">
          <svg class="fieldIcon" viewBox="0 0 24 24" fill="none"><path d="M18 12H4m0 0 5-5m-5 5 5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <span>Exit date</span>
        </div>
        <div class="inputWrap">
          <input class="input" type="date" id="exitDate" />
          <svg class="calIcon" viewBox="0 0 24 24" fill="none"><path d="M7 2v3M17 2v3M3 9h18M5 5h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>

      <div class="quick-pills">
        <button class="pill quickBtn" type="button" data-quick="1">1</button>
        <button class="pill quickBtn" type="button" data-quick="7">7</button>
        <button class="pill quickBtn" type="button" data-quick="14">14</button>
        <button class="pill quickBtn" type="button" data-quick="30">30</button>
      </div>

      <p class="tripMeta">Trip length: <strong id="tripLength">—</strong></p>
      <div class="actions">
        <button id="saveTripBtn" type="button" class="btn-primary">Save</button>
        <div class="subActions">
          <button id="swapDatesBtn" type="button" class="secondary hide">Swap dates</button>
          <button id="cancelEditBtn" type="button" class="secondary hide">Cancel</button>
        </div>
      </div>
      <div id="tripError" class="error"></div>
    </section>

    <section class="card">
      <h3 class="tripsTitle">Your trips</h3>
      <div id="tripsEmpty" class="tripSub">You haven’t added any trips yet.</div>
      <div id="tripsList"></div>
    </section>

    <div class="subtitle">Estimates only. Verify official Schengen rules.</div>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite">
    <span id="toastText"></span>
    <button id="undoBtn" class="secondary hide" type="button">Undo</button>
  </div>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').catch(() => {});
    }
  </script>
</body>
</html>
